You are working on an already running production-like booking backend with live demo data.
âš ï¸ IMPORTANT: DO NOT delete, truncate, reset, or overwrite any existing tables or demo records.
Only apply NON-DESTRUCTIVE schema updates (ADD columns if missing, ADD new tables if required).

Your task is to EXTEND the current system safely.

âœ… 1. booking_type FIELD (SAFE ADD ONLY)
âœ… Add new column ONLY IF IT DOES NOT EXIST:
booking_type ENUM(
  'point_to_point',
  'airport_transfer',
  'city_tour',
  'hourly_rental'
)


Do NOT drop any table

Do NOT reset bookings

Apply via ALTER TABLE ONLY

âœ… 2. VEHICLE CATEGORY SYSTEM (SAFE ADD)
âœ… If vehicle categories table already exists:

Compare schema

ONLY ADD missing columns:

passenger_capacity
luggage_capacity
hourly_price
per_km_price
active

âœ… If table does NOT exist:

Create new table without touching old vehicle data.

âœ… 3. CLIENT VEHICLE SEEDING (SAFE MERGE)

Insert ONLY if not already present:

Name	Category	Passengers	Luggage
GMC	suv	6	6
BMW 7 Series	luxury	4	3
Lexus	luxury	4	3
Tesla	luxury	4	2
BYD Han	luxury	4	3
BYD Song	suv	5	5
Mercedes V Class	van	7	7

âš ï¸ If record exists â†’ update capacities only (DO NOT delete).

âœ… 4. AUTO VEHICLE SELECTION (NON-BREAKING)

DO NOT change existing selection logic.
Only ADD a secondary validator:

if passengers > capacity OR luggage > capacity:
  reject that vehicle


Then choose cheapest eligible.

âœ… 5. FARE ENGINE (SAFE PATCH)

Apply ONLY to:

/api/bookings/calculate-fare

/api/bookings/create-booking

If missing parameters:

Return 400 error

DO NOT apply fallback flat AED 150

Add surcharges safely:

airport_transfer â†’ +10%

city_tour/hourly_rental â†’ hourly_price Ã— hours

âœ… 6. PHONE & EMAIL SAFE HANDLING

Do NOT overwrite existing phone/email logic.
ONLY EXTEND payload to include:

caller_number
confirmed_contact_number


Email:

Validate with regex

If invalid â†’ return validation error (DO NOT save junk)

âœ… 7. DEMO DATA PROTECTION RULE

ðŸš« You are strictly NOT allowed to:

DELETE demo bookings

DELETE vehicles

DELETE users

TRUNCATE any table

âœ… You ARE allowed to:

ALTER tables

ADD columns

ADD indexes

ADD validation logic

âœ… 8. API DOCUMENTATION REPORT (MANDATORY OUTPUT)

After making changes, YOU MUST PRINT BACK:

âœ… All available API routes (method + path)

âœ… Payload format for:

calculate-fare

create-booking

âœ… Vehicle schema (final)

âœ… booking_type validation proof

âœ… Sample working request & response

âœ… 9. SYSTEM VERIFICATION OUTPUT

After restart, console must show:

âœ… Existing data preserved
âœ… booking_type column verified
âœ… Vehicle capacities enforced
âœ… Fare engine online
âœ… API backward compatible

âœ… 10. ABSOLUTE RULE

DO NOT modify:

Authentication

Dashboard frontend

Analytics reports

Existing customer records

ONLY extend safely.

âœ… FINAL DELIVERABLE FROM AGENT:

âœ… List of updated tables

âœ… List of new columns added

âœ… Confirmed non-destructive migration

âœ… Updated API contract

âœ… One successful fare calculation example

âœ… One successful booking example